<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MyWeb - Search</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<canvas id="starfield" data-color="white"></canvas>

<nav>
  <a href="index.html">Code Page</a>
</nav>

<main>
<h1>MyWeb Search</h1>
<div class="search-bar">
  <input id="query" type="text" placeholder="Enter search term...">
  <button id="searchBtn">Search</button>
</div>
<div id="results"></div>
</main>

<script src="starfield.js"></script>
<script>
async function performWikiSearch(query) {
  const url = `https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&utf8=&format=json&origin=*`;
  const res = await fetch(url);
  const data = await res.json();
  return data.query && data.query.search ? data.query.search : [];
}

async function showResultsFor(query) {
  const results = document.getElementById('results');
  results.innerHTML = "<p style='color:#aaa'>Searching...</p>";
  try {
    const items = await performWikiSearch(query);
    if (!items.length) {
      results.innerHTML = "<p style='color:#ccc'>No results found.</p>";
      return;
    }
    results.innerHTML = "";
    items.forEach(item => {
      const link = `https://en.wikipedia.org/?curid=${item.pageid}`;
      const el = document.createElement('div');
      el.className = "result-card";
      el.innerHTML = `
        <h3><a href="${link}" target="_blank" rel="noopener noreferrer">${item.title}</a></h3>
        <p>${item.snippet}...</p>
      `;
      results.appendChild(el);
    });
  } catch (err) {
    results.innerHTML = "<p style='color:#ff9999'>An error occurred while searching.</p>";
    console.error(err);
  }
}

const input = document.getElementById('query');
const btn = document.getElementById('searchBtn');
async function doSearch() {
  const q = input.value.trim();
  if (!q) return;
  await showResultsFor(q);
}

btn.addEventListener('click', doSearch);
input.addEventListener('keydown', e => { if(e.key==='Enter') doSearch(); });
</script>
</body>
</html>
