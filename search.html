<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Search â€” MyWeb</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<canvas id="starfield"></canvas>

<main style="padding:50px; max-width:800px; margin:0 auto;">
    <div style="margin:30px 0; display:flex; gap:10px;">
        <input id="query" type="text" placeholder="Enter search term..." 
               style="flex:1; font-family:monospace; padding:12px; background:black; color:#00ff00; border:2px solid #00ff00; border-radius:8px;">
        <div class="code-btn" data-target="#" style="padding:12px;">&lt;script&gt; searchDo() &lt;/script&gt;<span class="last-line"></span></div>
    </div>

    <div id="results" style="margin-top:30px; display:flex; flex-direction:column; gap:10px;"></div>
</main>

<script src="starfield.js"></script>
<script>
// --- Fixed Search Page Logic ---
(function(){
    const TYPING_SPEED = 80;
    const SPARKLE_COUNT = 14;

    const searchBtn = document.querySelector('.code-btn');
    const input = document.getElementById('query');
    const resultsDiv = document.getElementById('results');

    function typeAndSparkle(el, onComplete){
        const pre = el;
        let fullText = pre.textContent.replace(/\u00A0/g,'').trim();
        pre.textContent='';
        let i=0;
        function step(){
            if(i<=fullText.length){
                pre.textContent = fullText.slice(0,i);
                i++;
                setTimeout(step,TYPING_SPEED);
            } else {
                sparkle(el,onComplete);
            }
        }
        step();
    }

    function sparkle(hostEl,onDone){
        const container=document.createElement('div');
        container.className='sparkle';
        hostEl.appendChild(container);
        const rect=hostEl.getBoundingClientRect();
        for(let k=0;k<SPARKLE_COUNT;k++){
            const dot=document.createElement('div');
            dot.className='dot';
            dot.style.left=(Math.random()*rect.width)+'px';
            dot.style.top=(Math.random()*rect.height)+'px';
            dot.style.animationDelay=(Math.random()*200)+'ms';
            container.appendChild(dot);
        }
        setTimeout(()=>{container.remove(); if(onDone) onDone();},900);
    }

    searchBtn.addEventListener('click',()=>{
        const query = input.value.trim();
        if(!query) return;
        typeAndSparkle(searchBtn,()=>{
            fetch(`https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&utf8=&format=json&origin=*`)
            .then(res=>res.json())
            .then(data=>{
                resultsDiv.innerHTML='';
                data.query.search.forEach(item=>{
                    const link=`https://en.wikipedia.org/?curid=${item.pageid}`;
                    const el=document.createElement('div');
                    el.style.background='black';
                    el.style.color='#00ff00';
                    el.style.padding='10px';
                    el.style.border='2px solid #00ff00';
                    el.style.borderRadius='8px';
                    el.innerHTML=`<h3 style="margin:0;"><a href="${link}" target="_blank">${item.title}</a></h3>
                                    <p style="margin:0;">${item.snippet}...</p>`;
                    resultsDiv.appendChild(el);
                });
                // Enable scrolling
                resultsDiv.style.overflowY='auto';
                resultsDiv.style.maxHeight='70vh';
            });
        });
    });
})();
</script>

</body>
</html>
